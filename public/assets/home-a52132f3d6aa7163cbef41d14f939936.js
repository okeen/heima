((function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=Object.prototype.hasOwnProperty,d=function(a,b){function e(){this.constructor=a}for(var d in b)c.call(b,d)&&(a[d]=b[d]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};a=function(a){function c(){this.rebuildMosaic=b(this.rebuildMosaic,this),this.delayedFadeIn=b(this.delayedFadeIn,this),this.showMosaic=b(this.showMosaic,this),this.render=b(this.render,this),c.__super__.constructor.apply(this,arguments)}return d(c,a),c.prototype.tagName="ul",c.prototype.textItemIdex=0,c.prototype.initialize=function(a){return a==null&&(a={}),this.el=a.el||$("ul.nine_nine_mosaic"),this.imageItems=$(this.el).find("li.item.image_mosaic_panel"),this.textItems=$(this.el).find("li.item.text_mosaic_panel"),this.mosaicOptions={itemSelector:"li",filter:".shown",layoutMode:"fitRows"},this.render()},c.prototype.render=function(){return this.createVoidPanels(),this.imageItems.detach(),this.showMosaic(),$(this.el).removeClass("hiding")},c.prototype.createVoidPanels=function(){var a,b,c,d,e,f;this.voidPanels=[],this.centerVoid=$("<li class='center_void void_item'><div></div></li>"),this.voidPanels=function(){var b;b=[];for(a=0;a<=7;a++)b.push($("<li class='void_item'><div></div></li>."));return b}(),e=this.voidPanels,f=[];for(c=0,d=e.length;c<d;c++)b=e[c],f.push(b.appendTo(this.el));return f},c.prototype.showMosaic=function(){var a=this;return $(this.el).animate({opacity:0},500),$(this.el).find("li").animate({opacity:0},500),setTimeout(function(){var b,c,d,e,f;$(a.el).animate({opacity:1},500),a.rebuildMosaic(),e=$(a.el).find("li"),f=[];for(c=0,d=e.length;c<d;c++)b=e[c],f.push(a.delayedFadeIn(b));return f},500),setTimeout(function(){return a.showMosaic()},5e3)},c.prototype.delayedFadeIn=function(a){var b,c=this;return b=Math.ceil(1+Math.random()*600),setTimeout(function(){return $(a).animate({opacity:1},400)},b)},c.prototype.rebuildMosaic=function(){var a,b,c,d,e,f,g,h,i,j,k,l;b=$(this.el).find("li.item, li.void_item").detach(),d=this.imageItems.slice(0,Math.ceil(1+Math.random()*2)),g=this.textItems[this.textItemIdex++%this.textItems.length],f=this.voidPanels.slice(0,7-d.length);for(h=0,j=d.length;h<j;h++)c=d[h],f.push(c);f.push(g),this.randomizePanels(f),a=f[5],f[4]=this.centerVoid,f.push(a),l=[];for(i=0,k=f.length;i<k;i++)e=f[i],l.push($(e).appendTo($(this.el)));return l},c.prototype.randomizePanels=function(a){return a.sort(function(a){return Math.round(Math.random())-.5})},c}(Backbone.View),(typeof exports!="undefined"&&exports!==null?exports:this).NineNineMosaicView=a})).call(this),function(){$(function(){return this.mosaic=new NineNineMosaicView})}.call(this);